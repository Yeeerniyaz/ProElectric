<!doctype html>
<html lang="ru" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>ProElectro Admin</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap"
      rel="stylesheet"
    />
    <link href="css/style.css" rel="stylesheet" />
  </head>
  <body>
    <div id="loginOverlay" class="login-container">
      <div class="login-card fade-in-up">
        <div class="text-center mb-5">
          <div class="logo-icon mb-3">
            <i class="bi bi-lightning-charge-fill"></i>
          </div>
          <h2 class="fw-bold text-white">ProElectro</h2>
          <p class="text-muted">Enterprise System</p>
        </div>
        <form id="loginForm">
          <div class="form-floating mb-3">
            <input
              type="password"
              class="form-control"
              id="passwordInput"
              placeholder="Access Key"
              required
            />
            <label for="passwordInput">Access Key</label>
          </div>
          <button
            type="submit"
            class="btn btn-primary w-100 py-3 fw-bold rounded-4"
          >
            –í–û–ô–¢–ò
          </button>
        </form>
      </div>
    </div>

    <div id="app" class="app-wrapper" style="display: none !important">
      <header class="app-header">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h5 class="m-0 fw-bold text-white" id="pageTitle">–î–∞—à–±–æ—Ä–¥</h5>
            <div class="d-flex align-items-center gap-1">
              <span class="indicator-dot online"></span>
              <small class="text-muted" style="font-size: 10px">ONLINE</small>
            </div>
          </div>
          <button class="btn btn-icon text-danger" onclick="logout()">
            <i class="bi bi-box-arrow-right"></i>
          </button>
        </div>
      </header>

      <main class="app-content pb-5 mb-5">
        <div id="view-dashboard" class="view-section fade-in">
          <div class="kpi-scroll-container mb-4">
            <div class="d-flex gap-3" id="kpiGrid"></div>
          </div>

          <div class="row g-2 mb-4">
            <div class="col-6">
              <button
                class="btn btn-action w-100"
                data-bs-toggle="modal"
                data-bs-target="#manualOrderModal"
              >
                <i class="bi bi-plus-circle-fill text-success mb-2 fs-3"></i>
                <span>–ù–æ–≤—ã–π –∑–∞–∫–∞–∑</span>
              </button>
            </div>
            <div class="col-6">
              <button
                class="btn btn-action w-100"
                data-bs-toggle="modal"
                data-bs-target="#transferModal"
              >
                <i class="bi bi-arrow-left-right text-warning mb-2 fs-3"></i>
                <span>–ü–µ—Ä–µ–≤–æ–¥</span>
              </button>
            </div>
          </div>

          <h6 class="section-title">–°—á–µ—Ç–∞</h6>
          <div
            id="dashboardAccounts"
            class="d-flex flex-column gap-2 mb-4"
          ></div>

          <div class="d-flex justify-content-between align-items-center mb-2">
            <h6 class="section-title m-0">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</h6>
            <a href="#orders" class="text-warning text-decoration-none small"
              >–í—Å–µ ></a
            >
          </div>
          <div id="recentOrdersBody" class="d-flex flex-column gap-2"></div>
        </div>

        <div
          id="view-orders"
          class="view-section fade-in"
          style="display: none"
        >
          <div class="filters-scroll mb-3">
            <button
              class="filter-chip active"
              onclick="App.filterOrders('all')"
              data-status="all"
            >
              –í—Å–µ
            </button>
            <button
              class="filter-chip"
              onclick="App.filterOrders('new')"
              data-status="new"
            >
              –ù–æ–≤—ã–µ
            </button>
            <button
              class="filter-chip"
              onclick="App.filterOrders('discuss')"
              data-status="discuss"
            >
              –ó–∞–º–µ—Ä
            </button>
            <button
              class="filter-chip"
              onclick="App.filterOrders('work')"
              data-status="work"
            >
              –í —Ä–∞–±–æ—Ç–µ
            </button>
            <button
              class="filter-chip"
              onclick="App.filterOrders('done')"
              data-status="done"
            >
              –ì–æ—Ç–æ–≤—ã–µ
            </button>
          </div>

          <div class="search-bar mb-3">
            <i class="bi bi-search"></i>
            <input
              type="text"
              id="orderSearchInput"
              placeholder="–ü–æ–∏—Å–∫ (–ò–º—è, –¢–µ–ª–µ—Ñ–æ–Ω, ID)"
            />
          </div>

          <div id="allOrdersBody" class="d-flex flex-column gap-3"></div>

          <div
            id="ordersPagination"
            class="d-flex justify-content-center align-items-center gap-3 mt-4 mb-5"
          ></div>
        </div>

        <div
          id="view-finance"
          class="view-section fade-in"
          style="display: none"
        >
          <div id="financeAccountsGrid" class="row g-3 mb-4"></div>
          <div
            class="alert alert-dark border-secondary d-flex align-items-center"
          >
            <i class="bi bi-info-circle text-warning me-2"></i>
            <small>–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è</small>
          </div>
        </div>

        <div id="view-crm" class="view-section fade-in" style="display: none">
          <div class="search-bar mb-3">
            <i class="bi bi-search"></i>
            <input
              type="text"
              id="crmSearchInput"
              placeholder="–ü–æ–∏—Å–∫ –ø–æ ID –∏–ª–∏ –ò–º–µ–Ω–∏"
            />
          </div>
          <div id="usersTableBody" class="d-flex flex-column gap-2"></div>
        </div>

        <div
          id="view-settings"
          class="view-section fade-in"
          style="display: none"
        >
          <form id="fullSettingsForm">
            <div class="settings-card mb-3">
              <h6 class="text-warning mb-3">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h6>
              <div class="mb-2">
                <label>–ì–∞–∑–æ–±–ª–æ–∫</label
                ><input name="wall_light" class="form-control" />
              </div>
              <div class="mb-2">
                <label>–ö–∏—Ä–ø–∏—á</label
                ><input name="wall_medium" class="form-control" />
              </div>
              <div class="mb-2">
                <label>–ë–µ—Ç–æ–Ω</label
                ><input name="wall_heavy" class="form-control" />
              </div>
              <div class="mb-2">
                <label>–ú–∞—Ç–µ—Ä–∏–∞–ª/–º¬≤</label
                ><input name="material_m2" class="form-control" />
              </div>
            </div>
            <div class="settings-card mb-3">
              <h6 class="text-warning mb-3">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (%)</h6>
              <div class="input-group mb-2">
                <span class="input-group-text">–ë–∏–∑–Ω–µ—Å</span>
                <input name="business_percent" class="form-control" />
                <span class="input-group-text">–û–∫–ª–∞–¥</span>
                <input name="staff_percent" class="form-control" />
              </div>
            </div>
            <button class="btn btn-primary w-100 py-3 fw-bold rounded-4">
              –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
            </button>
          </form>
        </div>
      </main>

      <nav class="bottom-nav">
        <a href="#dashboard" class="nav-item active">
          <i class="bi bi-house-door-fill"></i>
          <span>–ì–ª–∞–≤–Ω–∞—è</span>
        </a>
        <a href="#orders" class="nav-item">
          <i class="bi bi-card-checklist"></i>
          <span>–ó–∞–∫–∞–∑—ã</span>
        </a>
        <a href="#finance" class="nav-item">
          <i class="bi bi-wallet-fill"></i>
          <span>–§–∏–Ω–∞–Ω—Å—ã</span>
        </a>
        <a href="#crm" class="nav-item">
          <i class="bi bi-people-fill"></i>
          <span>–ö–æ–º–∞–Ω–¥–∞</span>
        </a>
        <a href="#settings" class="nav-item">
          <i class="bi bi-gear-fill"></i>
          <span>–ú–µ–Ω—é</span>
        </a>
      </nav>
    </div>

    <div class="modal fade" id="editOrderModal" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="editOrderForm">
              <input type="hidden" name="orderId" />

              <div class="mb-3">
                <label class="form-label text-muted">–°—Ç–∞—Ç—É—Å</label>
                <select name="status" class="form-select form-select-lg">
                  <option value="new">üÜï –ù–æ–≤—ã–π</option>
                  <option value="discuss">üí¨ –û–±—Å—É–∂–¥–µ–Ω–∏–µ</option>
                  <option value="work">üõ† –í —Ä–∞–±–æ—Ç–µ</option>
                  <option value="done">‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω</option>
                  <option value="cancel">‚ùå –û—Ç–º–µ–Ω–∞</option>
                </select>
              </div>
              <div class="mb-4">
                <label class="form-label text-muted">–ú–∞—Å—Ç–µ—Ä</label>
                <select
                  name="assignee_id"
                  class="form-select form-select-lg"
                ></select>
              </div>

              <div class="card bg-dark border-secondary p-3 mb-3">
                <h6 class="text-warning mb-3">
                  <i class="bi bi-cash"></i> –§–∏–Ω–∞–Ω—Å—ã
                </h6>
                <div class="mb-2">
                  <label class="small text-muted">–§–∞–∫—Ç. —Ü–µ–Ω–∞</label>
                  <input
                    name="final_price"
                    type="number"
                    class="form-control"
                    placeholder="0"
                  />
                </div>
                <div class="mb-0">
                  <label class="small text-muted">–†–∞—Å—Ö–æ–¥—ã</label>
                  <input
                    name="expenses"
                    type="number"
                    class="form-control"
                    placeholder="0"
                  />
                </div>
              </div>

              <button class="btn btn-success w-100 py-3 rounded-4 fw-bold">
                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="manualOrderModal" tabindex="-1">
      <div class="modal-dialog modal-fullscreen-sm-down">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">–ù–æ–≤—ã–π –∑–∞–∫–∞–∑</h5>
            <button
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="manualOrderForm">
              <input
                name="clientName"
                class="form-control mb-3 py-3"
                placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞"
                required
              />
              <input
                name="clientPhone"
                class="form-control mb-3 py-3"
                placeholder="–¢–µ–ª–µ—Ñ–æ–Ω"
              />
              <input
                name="area"
                type="number"
                class="form-control mb-3 py-3"
                placeholder="–ü–ª–æ—â–∞–¥—å (–º¬≤)"
                required
              />
              <select name="wallType" class="form-select mb-3 py-3">
                <option value="light">–ì–∞–∑–æ–±–ª–æ–∫</option>
                <option value="medium">–ö–∏—Ä–ø–∏—á</option>
                <option value="heavy">–ë–µ—Ç–æ–Ω</option>
              </select>
              <button class="btn btn-primary w-100 py-3 rounded-4">
                –°–æ–∑–¥–∞—Ç—å
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="transferModal" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">–ü–µ—Ä–µ–≤–æ–¥</h5>
            <button
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="transferForm">
              <select
                name="fromId"
                id="fromAccount"
                class="form-select mb-2 py-3"
              ></select>
              <div class="text-center my-1">
                <i class="bi bi-arrow-down"></i>
              </div>
              <select
                name="toId"
                id="toAccount"
                class="form-select mb-3 py-3"
              ></select>
              <input
                name="amount"
                type="number"
                class="form-control mb-3 py-3"
                placeholder="–°—É–º–º–∞"
                required
              />
              <input
                name="comment"
                class="form-control mb-3"
                placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"
              />
              <button
                class="btn btn-warning w-100 py-3 rounded-4 text-dark fw-bold"
              >
                –ü–µ—Ä–µ–≤–µ—Å—Ç–∏
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>
