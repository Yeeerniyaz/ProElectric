<!doctype html>
<html lang="ru" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ProElectro Enterprise ERP</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link href="css/style.css" rel="stylesheet" />
  </head>
  <body>
    <div id="loginOverlay">
      <div
        class="glass-card p-5 text-center"
        style="width: 400px; max-width: 90%"
      >
        <div class="mb-4">
          <i
            class="bi bi-lightning-charge-fill text-warning"
            style="font-size: 3rem"
          ></i>
          <h3 class="text-white mt-3 fw-bold">ProElectro ERP</h3>
          <p class="text-muted small">Enterprise Resource Planning v5.0</p>
        </div>
        <form id="loginForm">
          <div class="mb-3 position-relative">
            <i
              class="bi bi-key position-absolute top-50 start-0 translate-middle-y ms-3 text-muted"
            ></i>
            <input
              type="password"
              id="passwordInput"
              class="form-control bg-dark text-white border-secondary ps-5"
              placeholder="Access Key"
              required
            />
          </div>
          <button type="submit" class="btn btn-warning w-100 fw-bold py-2">
            –í–û–ô–¢–ò –í –°–ò–°–¢–ï–ú–£
          </button>
        </form>
      </div>
    </div>

    <div id="app" class="app-container" style="display: none">
      <div class="sidebar">
        <div class="d-flex align-items-center gap-2 mb-5 px-2">
          <div class="bg-warning rounded p-1">
            <i class="bi bi-lightning-charge-fill text-dark"></i>
          </div>
          <span class="fs-5 fw-bold text-white tracking-tight">ProElectro</span>
        </div>

        <div class="d-grid gap-2 navigation">
          <a
            href="#dashboard"
            class="btn btn-outline-secondary text-start border-0 nav-link active"
          >
            <i class="bi bi-grid-1x2-fill me-2"></i> –î–∞—à–±–æ—Ä–¥
          </a>
          <a
            href="#orders"
            class="btn btn-outline-secondary text-start border-0 nav-link"
          >
            <i class="bi bi-box-seam-fill me-2"></i> –ó–∞–∫–∞–∑—ã
          </a>
          <a
            href="#finance"
            class="btn btn-outline-secondary text-start border-0 nav-link"
          >
            <i class="bi bi-wallet-fill me-2"></i> –§–∏–Ω–∞–Ω—Å—ã
          </a>
          <a
            href="#crm"
            class="btn btn-outline-secondary text-start border-0 nav-link"
          >
            <i class="bi bi-people-fill me-2"></i> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
          </a>
          <a
            href="#settings"
            class="btn btn-outline-secondary text-start border-0 nav-link"
          >
            <i class="bi bi-sliders me-2"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
          </a>
        </div>

        <div class="mt-auto pt-4 border-top border-secondary">
          <button
            class="btn btn-danger w-100 btn-sm bg-opacity-10 text-danger border-0"
            onclick="logout()"
          >
            <i class="bi bi-box-arrow-left me-2"></i> –í—ã–π—Ç–∏
          </button>
        </div>
      </div>

      <div class="main-content">
        <header class="d-flex justify-content-between align-items-center mb-4">
          <h4 class="text-white fw-bold m-0" id="pageTitle">
            –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
          </h4>
          <div class="d-flex gap-3 align-items-center">
            <span
              class="badge bg-success bg-opacity-25 text-success border border-success px-3 py-2"
            >
              <i class="bi bi-wifi"></i> Online
            </span>
            <div
              class="rounded-circle bg-secondary d-flex align-items-center justify-content-center text-white"
              style="width: 35px; height: 35px"
            >
              <i class="bi bi-person-fill"></i>
            </div>
          </div>
        </header>

        <div id="view-dashboard" class="view-section">
          <div id="kpiGrid" class="account-grid mb-4"></div>

          <div class="row g-4">
            <div class="col-xl-8">
              <div class="glass-card p-4 h-100">
                <div class="d-flex justify-content-between mb-4">
                  <h5 class="text-white mb-0">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</h5>
                  <a href="#orders" class="btn btn-sm btn-outline-light"
                    >–í—Å–µ –∑–∞–∫–∞–∑—ã</a
                  >
                </div>
                <div class="table-responsive">
                  <table class="custom-table">
                    <thead>
                      <tr>
                        <th>ID</th>
                        <th>–ö–ª–∏–µ–Ω—Ç</th>
                        <th>–°—É–º–º–∞</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
                      </tr>
                    </thead>
                    <tbody id="recentOrdersBody"></tbody>
                  </table>
                </div>
              </div>
            </div>
            <div class="col-xl-4">
              <div class="glass-card p-4 h-100">
                <h5 class="text-white mb-4">–°—á–µ—Ç–∞</h5>
                <div id="dashboardAccounts"></div>
                <a
                  href="#finance"
                  class="btn btn-outline-warning w-100 mt-3 btn-sm"
                  >–ü–µ—Ä–µ–π—Ç–∏ –≤ —Ñ–∏–Ω–∞–Ω—Å—ã</a
                >
              </div>
            </div>
          </div>
        </div>

        <div id="view-orders" class="view-section" style="display: none">
          <div class="glass-card p-4">
            <div
              class="d-flex flex-wrap justify-content-between align-items-center mb-4 gap-3"
            >
              <div class="d-flex gap-2">
                <button
                  class="btn btn-primary filter-btn active"
                  onclick="App.applyOrderFilter('all')"
                  data-status="all"
                >
                  –í—Å–µ
                </button>
                <button
                  class="btn btn-outline-secondary filter-btn"
                  onclick="App.applyOrderFilter('new')"
                  data-status="new"
                >
                  –ù–æ–≤—ã–µ
                </button>
                <button
                  class="btn btn-outline-secondary filter-btn"
                  onclick="App.applyOrderFilter('work')"
                  data-status="work"
                >
                  –í —Ä–∞–±–æ—Ç–µ
                </button>
                <button
                  class="btn btn-outline-secondary filter-btn"
                  onclick="App.applyOrderFilter('done')"
                  data-status="done"
                >
                  –ì–æ—Ç–æ–≤—ã–µ
                </button>
              </div>
              <div class="d-flex gap-2">
                <input
                  type="text"
                  id="orderSearchInput"
                  class="form-control bg-dark text-white border-secondary"
                  placeholder="–ü–æ–∏—Å–∫ (ID, –ò–º—è, –¢–µ–ª)..."
                />
                <button
                  class="btn btn-success text-nowrap"
                  data-bs-toggle="modal"
                  data-bs-target="#manualOrderModal"
                >
                  <i class="bi bi-plus-lg me-1"></i> –ù–æ–≤—ã–π –∑–∞–∫–∞–∑
                </button>
              </div>
            </div>

            <div class="table-responsive">
              <table class="custom-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>–ö–ª–∏–µ–Ω—Ç</th>
                    <th>–°—É–º–º–∞</th>
                    <th>–ú–µ–Ω–µ–¥–∂–µ—Ä</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î–∞—Ç–∞</th>
                    <th class="text-end">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</th>
                  </tr>
                </thead>
                <tbody id="allOrdersBody"></tbody>
              </table>
            </div>

            <div
              class="d-flex justify-content-center mt-4"
              id="ordersPagination"
            ></div>
          </div>
        </div>

        <div id="view-finance" class="view-section" style="display: none">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h5 class="text-white">–ë–∞–ª–∞–Ω—Å —Å—á–µ—Ç–æ–≤</h5>
            <button
              class="btn btn-warning"
              data-bs-toggle="modal"
              data-bs-target="#transferModal"
            >
              <i class="bi bi-arrow-left-right me-2"></i> –ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤
            </button>
          </div>

          <div class="row g-4 mb-4" id="financeAccountsGrid"></div>

          <div class="glass-card p-4">
            <h5 class="text-white mb-3">–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h5>
            <p class="text-muted">
              –†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (–±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ v5.1)
            </p>
          </div>
        </div>

        <div id="view-crm" class="view-section" style="display: none">
          <div class="glass-card p-4">
            <h5 class="text-white mb-4">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –†–æ–ª–∏</h5>
            <div class="table-responsive">
              <table class="custom-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>–ò–º—è</th>
                    <th>Username</th>
                    <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                    <th>–†–æ–ª—å</th>
                    <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                  </tr>
                </thead>
                <tbody id="usersTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <div id="view-settings" class="view-section" style="display: none">
          <div class="row">
            <div class="col-md-6">
              <div class="glass-card p-4">
                <h5 class="text-white mb-4">‚öôÔ∏è –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h5>
                <form id="fullSettingsForm">
                  <h6 class="text-warning mb-3">–ü—Ä–∞–π—Å-–ª–∏—Å—Ç (–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä)</h6>
                  <div class="row g-3 mb-4">
                    <div class="col-6">
                      <label class="text-muted small">–ì–∞–∑–æ–±–ª–æ–∫</label
                      ><input
                        name="wall_light"
                        class="form-control bg-dark text-white border-secondary"
                      />
                    </div>
                    <div class="col-6">
                      <label class="text-muted small">–ö–∏—Ä–ø–∏—á</label
                      ><input
                        name="wall_medium"
                        class="form-control bg-dark text-white border-secondary"
                      />
                    </div>
                    <div class="col-6">
                      <label class="text-muted small">–ë–µ—Ç–æ–Ω</label
                      ><input
                        name="wall_heavy"
                        class="form-control bg-dark text-white border-secondary"
                      />
                    </div>
                    <div class="col-6">
                      <label class="text-muted small">–ú–∞—Ç–µ—Ä–∏–∞–ª/–º¬≤</label
                      ><input
                        name="material_m2"
                        class="form-control bg-dark text-white border-secondary"
                      />
                    </div>
                  </div>

                  <h6 class="text-warning mb-3">–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç (–î–µ—Ç–∞–ª—å–Ω–æ)</h6>
                  <div class="row g-3 mb-4">
                    <div class="col-4">
                      <label class="text-muted small">–¢–æ—á–∫–∞</label
                      ><input
                        name="work_point"
                        class="form-control bg-dark text-white border-secondary"
                      />
                    </div>
                    <div class="col-4">
                      <label class="text-muted small">–®—Ç—Ä–æ–±–∞</label
                      ><input
                        name="work_strobe"
                        class="form-control bg-dark text-white border-secondary"
                      />
                    </div>
                    <div class="col-4">
                      <label class="text-muted small">–ö–∞–±–µ–ª—å/–º</label
                      ><input
                        name="work_cable"
                        class="form-control bg-dark text-white border-secondary"
                      />
                    </div>
                    <div class="col-6">
                      <label class="text-muted small">–°–±–æ—Ä–∫–∞ —â–∏—Ç–∞</label
                      ><input
                        name="work_shield_install"
                        class="form-control bg-dark text-white border-secondary"
                      />
                    </div>
                    <div class="col-6">
                      <label class="text-muted small">–ß–µ—Ä–Ω–æ–≤–æ–π —ç—Ç–∞–ø</label
                      ><input
                        name="work_check"
                        class="form-control bg-dark text-white border-secondary"
                      />
                    </div>
                  </div>

                  <h6 class="text-warning mb-3">–§–∏–Ω–∞–Ω—Å—ã (–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)</h6>
                  <div class="input-group mb-3">
                    <span
                      class="input-group-text bg-dark text-muted border-secondary"
                      >–ë–∏–∑–Ω–µ—Å %</span
                    >
                    <input
                      name="business_percent"
                      class="form-control bg-dark text-white border-secondary"
                    />
                    <span
                      class="input-group-text bg-dark text-muted border-secondary"
                      >–û–∫–ª–∞–¥ %</span
                    >
                    <input
                      name="staff_percent"
                      class="form-control bg-dark text-white border-secondary"
                    />
                  </div>

                  <button class="btn btn-warning w-100">
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="editOrderModal" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content bg-dark border-secondary text-white">
          <div class="modal-header border-secondary">
            <div>
              <h5 class="modal-title" id="editOrderTitle">
                –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
              </h5>
              <small class="text-muted"
                >–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–∞</small
              >
            </div>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="editOrderForm">
              <input type="hidden" name="orderId" />

              <div class="mb-3">
                <label class="form-label text-muted small"
                  >–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å</label
                >
                <select
                  name="status"
                  class="form-select bg-dark text-white border-secondary"
                >
                  <option value="new">üÜï –ù–æ–≤—ã–π</option>
                  <option value="work">üõ† –í —Ä–∞–±–æ—Ç–µ (–ó–∞–º–µ—Ä/–ú–æ–Ω—Ç–∞–∂)</option>
                  <option value="discuss">üí¨ –û–±—Å—É–∂–¥–µ–Ω–∏–µ</option>
                  <option value="done">‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω (–†–∞—Å—á–µ—Ç)</option>
                  <option value="cancel">‚ùå –û—Ç–º–µ–Ω–∞</option>
                </select>
              </div>

              <div class="mb-3">
                <label class="form-label text-muted small"
                  >–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</label
                >
                <select
                  name="assignee_id"
                  class="form-select bg-dark text-white border-secondary"
                ></select>
              </div>

              <div class="alert alert-info bg-opacity-10 border-0 fs-small">
                <i class="bi bi-info-circle me-1"></i> –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Å—Ç–∞—Ç—É—Å–∞
                <b>"–í—ã–ø–æ–ª–Ω–µ–Ω"</b>, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–µ—Ç –¥–æ–ª–∏
                (–ë–∏–∑–Ω–µ—Å/–û–∫–ª–∞–¥) –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç.
              </div>

              <button type="submit" class="btn btn-primary w-100">
                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="manualOrderModal" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content bg-dark border-secondary text-white">
          <div class="modal-header border-secondary">
            <h5 class="modal-title">–ù–æ–≤—ã–π –∑–∞–∫–∞–∑ (–í—Ä—É—á–Ω—É—é)</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="manualOrderForm">
              <div class="mb-3">
                <label class="small text-muted">–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞</label>
                <input
                  name="clientName"
                  class="form-control bg-dark text-white border-secondary"
                  required
                  placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê—Å–ª–∞–Ω"
                />
              </div>
              <div class="mb-3">
                <label class="small text-muted">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                <input
                  name="clientPhone"
                  class="form-control bg-dark text-white border-secondary"
                  placeholder="+7..."
                />
              </div>
              <div class="row g-2 mb-3">
                <div class="col-6">
                  <label class="small text-muted">–ü–ª–æ—â–∞–¥—å (–º¬≤)</label>
                  <input
                    name="area"
                    type="number"
                    class="form-control bg-dark text-white border-secondary"
                    required
                  />
                </div>
                <div class="col-6">
                  <label class="small text-muted">–¢–∏–ø —Å—Ç–µ–Ω</label>
                  <select
                    name="wallType"
                    class="form-select bg-dark text-white border-secondary"
                  >
                    <option value="light">–ì–∞–∑–æ–±–ª–æ–∫</option>
                    <option value="medium">–ö–∏—Ä–ø–∏—á</option>
                    <option value="heavy">–ë–µ—Ç–æ–Ω</option>
                  </select>
                </div>
              </div>
              <button type="submit" class="btn btn-success w-100">
                –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="transferModal" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content bg-dark border-secondary text-white">
          <div class="modal-header border-secondary">
            <h5 class="modal-title">üí∏ –ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="transferForm">
              <div class="mb-3">
                <label class="small text-muted">–û—Ç–∫—É–¥–∞ —Å–ø–∏—Å–∞—Ç—å</label>
                <select
                  name="fromId"
                  id="fromAccount"
                  class="form-select bg-dark text-white border-secondary"
                ></select>
              </div>
              <div class="mb-3">
                <label class="small text-muted">–ö—É–¥–∞ –∑–∞—á–∏—Å–ª–∏—Ç—å</label>
                <select
                  name="toId"
                  id="toAccount"
                  class="form-select bg-dark text-white border-secondary"
                ></select>
              </div>
              <div class="mb-3">
                <label class="small text-muted">–°—É–º–º–∞ (‚Ç∏)</label>
                <input
                  name="amount"
                  type="number"
                  class="form-control bg-dark text-white border-secondary"
                  required
                  min="1"
                />
              </div>
              <div class="mb-4">
                <label class="small text-muted">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                <input
                  name="comment"
                  class="form-control bg-dark text-white border-secondary"
                  placeholder="–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞..."
                />
              </div>
              <button type="submit" class="btn btn-warning w-100 fw-bold">
                –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>
