<!DOCTYPE html>
<html lang="ru" class="antialiased">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#2563eb">
    <meta name="description" content="ProElectro CRM - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏">
    <title>ProElectro | Enterprise CRM</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* Inline Critical CSS for Loading State */
        .cloak { opacity: 0; pointer-events: none; transition: opacity 0.3s; }
        .visible { opacity: 1; pointer-events: auto; }
        dialog::backdrop { background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(2px); }
    </style>
</head>
<body>

    <main id="login-screen" class="login-container" role="main">
        <div class="login-box card-elevation">
            <header class="text-center mb-6">
                <div class="brand-logo mb-4">‚ö°Ô∏è</div>
                <h2>ProElectro CRM</h2>
                <p class="text-secondary">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</p>
            </header>
            
            <form id="login-form" novalidate>
                <div class="form-group">
                    <label for="password" class="sr-only">–ü–∞—Ä–æ–ª—å</label>
                    <div class="input-wrapper">
                        <i data-feather="lock" class="input-icon"></i>
                        <input type="password" id="password" name="password" 
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞" 
                               autocomplete="current-password" 
                               required>
                    </div>
                </div>
                <button type="submit" class="btn primary full" data-loading-text="–í—Ö–æ–¥...">
                    <span>–í–æ–π—Ç–∏</span>
                    <i data-feather="arrow-right"></i>
                </button>
            </form>
            <div id="login-error" class="error-msg" role="alert" aria-live="polite"></div>
        </div>
    </main>

    <div id="app" class="app-container cloak" aria-hidden="true">
        
        <aside class="sidebar">
            <div class="brand">
                <div class="logo-circle">‚ö°Ô∏è</div>
                <div class="brand-text">
                    <span class="brand-name">ProElectro</span>
                    <span class="brand-desc">Enterprise</span>
                </div>
            </div>
            
            <nav class="menu" role="navigation">
                <button class="menu-item active" data-tab="dashboard" aria-current="page">
                    <i data-feather="pie-chart"></i> <span>–î–∞—à–±–æ—Ä–¥</span>
                </button>
                <button class="menu-item" data-tab="orders">
                    <i data-feather="layers"></i> <span>–ó–∞–∫–∞–∑—ã</span>
                </button>
                <button class="menu-item" data-tab="finance">
                    <i data-feather="dollar-sign"></i> <span>–§–∏–Ω–∞–Ω—Å—ã</span>
                </button>
                <button class="menu-item" data-tab="settings">
                    <i data-feather="sliders"></i> <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </button>
            </nav>
            
            <div class="sidebar-footer">
                <button id="logout-btn" class="btn-text-danger" data-action="logout">
                    <i data-feather="log-out"></i> –í—ã–π—Ç–∏
                </button>
            </div>
        </aside>

        <main class="main-content">
            
            <header class="top-bar">
                <h1 id="page-title" class="page-title">–û–±–∑–æ—Ä</h1>
                <div class="user-info">
                    <div id="loading-indicator" class="loader-spinner" aria-label="–ó–∞–≥—Ä—É–∑–∫–∞..."></div>
                    <div class="user-meta">
                        <span class="badge admin">Admin</span>
                        <time id="date-display" class="date-text"></time>
                    </div>
                </div>
            </header>

            <section id="tab-dashboard" class="tab-content active" role="tabpanel">
                
                <div class="kpi-grid">
                    <article class="card kpi-card">
                        <div class="kpi-icon blue"><i data-feather="activity"></i></div>
                        <div class="kpi-info">
                            <h3>–ê–∫—Ç–∏–≤–Ω—ã–µ</h3>
                            <p id="kpi-active" class="kpi-value skeleton-box">0</p>
                        </div>
                    </article>
                    <article class="card kpi-card">
                        <div class="kpi-icon green"><i data-feather="check-circle"></i></div>
                        <div class="kpi-info">
                            <h3>–ó–∞–≤–µ—Ä—à–µ–Ω–æ</h3>
                            <p id="kpi-done" class="kpi-value skeleton-box">0</p>
                        </div>
                    </article>
                    <article class="card kpi-card">
                        <div class="kpi-icon orange"><i data-feather="briefcase"></i></div>
                        <div class="kpi-info">
                            <h3>–û–±–æ—Ä–æ—Ç</h3>
                            <p id="kpi-revenue" class="kpi-value skeleton-box">0</p>
                        </div>
                    </article>
                    <article class="card kpi-card">
                        <div class="kpi-icon purple"><i data-feather="trending-up"></i></div>
                        <div class="kpi-info">
                            <h3>–ü—Ä–∏–±—ã–ª—å</h3>
                            <p id="kpi-profit" class="kpi-value skeleton-box">0</p>
                        </div>
                    </article>
                </div>

                <div class="section-header mt-8">
                    <h2>üî• –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
                </div>
                <div class="actions-grid">
                    <button class="btn primary action-card" data-action="open-modal" data-target="modal-create-order">
                        <div class="icon-bg"><i data-feather="plus-circle"></i></div>
                        <span>–ù–æ–≤—ã–π –∑–∞–∫–∞–∑</span>
                    </button>
                    <button class="btn secondary action-card" data-action="refresh">
                        <div class="icon-bg"><i data-feather="refresh-cw"></i></div>
                        <span>–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</span>
                    </button>
                </div>
            </section>

            <section id="tab-orders" class="tab-content" role="tabpanel" hidden>
                <div class="filters-bar">
                    <div class="filters" role="group" aria-label="–§–∏–ª—å—Ç—Ä –∑–∞–∫–∞–∑–æ–≤">
                        <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                        <button class="filter-btn" data-filter="new">–ù–æ–≤—ã–µ</button>
                        <button class="filter-btn" data-filter="work">–í —Ä–∞–±–æ—Ç–µ</button>
                        <button class="filter-btn" data-filter="done">–ê—Ä—Ö–∏–≤</button>
                    </div>
                    <button class="btn primary small" data-action="open-modal" data-target="modal-create-order" aria-label="–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑">
                        <i data-feather="plus"></i>
                        <span class="desktop-only">–°–æ–∑–¥–∞—Ç—å</span>
                    </button>
                </div>
                
                <div class="card table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th width="5%">ID</th>
                                <th width="20%">–ö–ª–∏–µ–Ω—Ç</th>
                                <th width="15%">–°—Ç–∞—Ç—É—Å</th>
                                <th width="15%">–ú–∞—Å—Ç–µ—Ä</th>
                                <th width="15%">–§–∏–Ω–∞–Ω—Å—ã</th>
                                <th width="15%">–ü—Ä–æ—Ñ–∏—Ç</th>
                                <th width="15%" class="text-right">–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="orders-table-body">
                            </tbody>
                    </table>
                    <div id="orders-empty" class="empty-state hidden">
                        <i data-feather="inbox"></i>
                        <p>–ó–∞–∫–∞–∑–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
                    </div>
                </div>
            </section>

            <section id="tab-finance" class="tab-content" role="tabpanel" hidden>
                <div class="finance-grid">
                    <article class="card">
                        <div class="card-header">
                            <h3>üí∞ –ö–∞—Å—Å—ã –∏ –°—á–µ—Ç–∞</h3>
                            <button class="btn-icon small" data-action="refresh-finance"><i data-feather="refresh-cw"></i></button>
                        </div>
                        <div id="accounts-list" class="accounts-list">
                            </div>
                    </article>
                    
                    <article class="card">
                        <h3>üìä –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h3>
                        <div class="table-scroll">
                            <table class="data-table small">
                                <thead>
                                    <tr>
                                        <th>–î–∞—Ç–∞</th>
                                        <th>–°—á–µ—Ç</th>
                                        <th>–¢–∏–ø</th>
                                        <th>–°—É–º–º–∞</th>
                                        <th>–ò–Ω—Ñ–æ</th>
                                    </tr>
                                </thead>
                                <tbody id="transactions-body">
                                    </tbody>
                            </table>
                        </div>
                    </article>
                </div>
            </section>

            <section id="tab-settings" class="tab-content" role="tabpanel" hidden>
                <div class="card max-w-4xl">
                    <div class="card-header">
                        <h3>üõ† –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è</h3>
                        <span class="badge warning">Auto-Save</span>
                    </div>
                    <p class="hint mb-4">–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ –≤ –±–æ—Ç–µ.</p>
                    <div id="settings-grid" class="settings-grid">
                        </div>
                </div>
            </section>

        </main>
    </div>

    <dialog id="modal-create-order" class="modal-native">
        <form id="create-order-form" method="dialog">
            <div class="modal-header">
                <h2>–ù–æ–≤—ã–π –∑–∞–∫–∞–∑</h2>
                <button type="button" class="close-btn" data-action="close-modal" data-target="modal-create-order">
                    <i data-feather="x"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="form-grid">
                    <div class="form-group">
                        <label>–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞</label>
                        <input type="text" name="clientName" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤" autocomplete="name" required>
                    </div>
                    <div class="form-group">
                        <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
                        <input type="tel" name="clientPhone" placeholder="+7 700 000 00 00" autocomplete="tel" required>
                    </div>
                </div>
                
                <div class="form-grid three-cols">
                    <div class="form-group">
                        <label>–ü–ª–æ—â–∞–¥—å (–º¬≤)</label>
                        <input type="number" name="area" placeholder="50" min="1" required>
                    </div>
                    <div class="form-group">
                        <label>–ö–æ–º–Ω–∞—Ç</label>
                        <input type="number" name="rooms" value="1" min="1" required>
                    </div>
                    <div class="form-group">
                        <label>–°—Ç–µ–Ω—ã</label>
                        <select name="wallType">
                            <option value="light">üß± –ì–∞–∑–æ–±–ª–æ–∫</option>
                            <option value="brick">üß± –ö–∏—Ä–ø–∏—á</option>
                            <option value="concrete">üèó –ë–µ—Ç–æ–Ω</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn secondary" data-action="close-modal" data-target="modal-create-order">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" class="btn primary">–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</button>
            </div>
        </form>
    </dialog>

    <dialog id="modal-add-expense" class="modal-native">
        <form id="add-expense-form" method="dialog">
            <div class="modal-header">
                <h2>–î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</h2>
                <button type="button" class="close-btn" data-action="close-modal" data-target="modal-add-expense">
                    <i data-feather="x"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="info-box mb-4">
                    <i data-feather="info"></i>
                    <span id="expense-order-info">–ó–∞–∫–∞–∑ #...</span>
                </div>
                <input type="hidden" id="expense-order-id" name="orderId">
                
                <div class="form-group">
                    <label>–°—É–º–º–∞ (‚Ç∏)</label>
                    <input type="number" name="amount" placeholder="0" min="0" inputmode="numeric" required>
                </div>
                
                <div class="form-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select name="category">
                        <option value="material">üîå –ú–∞—Ç–µ—Ä–∏–∞–ª (–î–æ–∫—É–ø–∫–∞)</option>
                        <option value="taxi">üöï –¢–∞–∫—Å–∏ / –î–æ—Å—Ç–∞–≤–∫–∞</option>
                        <option value="food">üçî –ü–∏—Ç–∞–Ω–∏–µ</option>
                        <option value="tools">üõ† –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</option>
                        <option value="other">üì¶ –ü—Ä–æ—á–µ–µ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                    <input type="text" name="comment" placeholder="–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—Ö–æ–¥–∞...">
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn secondary" data-action="close-modal" data-target="modal-add-expense">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" class="btn danger">–°–ø–∏—Å–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞</button>
            </div>
        </form>
    </dialog>

    <template id="tpl-order-row">
        <tr>
            <td class="font-mono text-sm order-id"></td>
            <td>
                <div class="client-name font-bold"></div>
                <div class="client-phone text-xs text-muted"></div>
            </td>
            <td><span class="badge status-badge"></span></td>
            <td class="master-info text-sm"></td>
            <td class="finance-info font-mono"></td>
            <td class="profit-info font-mono text-green"></td>
            <td class="text-right actions-cell">
                <button class="btn-icon small action-expense" title="–†–∞—Å—Ö–æ–¥">
                    <i data-feather="minus-circle"></i>
                </button>
            </td>
        </tr>
    </template>

    <template id="tpl-account-card">
        <div class="account-item">
            <div class="acc-icon-wrapper"></div>
            <div class="acc-details">
                <div class="acc-name"></div>
                <div class="acc-balance"></div>
            </div>
        </div>
    </template>

    <template id="tpl-setting-item">
        <div class="setting-item">
            <label class="setting-label"></label>
            <div class="input-suffix-wrapper">
                <input type="number" class="setting-input" inputmode="numeric">
                <span class="suffix">‚Ç∏</span>
            </div>
        </div>
    </template>

    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
    <script>
        // Init Icons
        feather.replace();
    </script>
</body>
</html>